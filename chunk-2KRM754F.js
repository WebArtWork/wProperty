import{d as U,g as q,k as B}from"./chunk-4JG5HFOE.js";import"./chunk-VV24HN3E.js";import{A as g,Gb as M,Ib as T,K as c,Lb as V,O as n,P as I,Q as C,Tb as u,U as b,Ub as F,Vb as L,Xb as N,Ya as x,a as f,ba as p,ca as o,da as a,ia as v,ja as m,ka as S,lb as E,pb as j,ua as w,v as k,z as _,zb as P}from"./chunk-7J63SMGH.js";function W(r,e){if(r&1){let h=v();o(0,"span",9),m("click",function(){_(h);let i=S();return g(i.us.setMode("dark"))}),w(1," dark_mode "),a()}}function z(r,e){if(r&1){let h=v();o(0,"span",10),m("click",function(){_(h);let i=S();return g(i.us.setMode())}),w(1," light_mode "),a()}}var D=(()=>{let e=class e{constructor(t,i,s,d,H,R,A,J){this.us=t,this.ui=i,this._alert=s,this._http=d,this._hash=H,this._router=R,this._form=A,this._translate=J,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user=u.user,this._set=l=>{if(l){let y=l.token||"";y&&this._http.set("token",y),localStorage.setItem("waw_user",JSON.stringify(l)),this.us.setUser(l),this.us.get(),this._router.navigateByUrl("/myproperties")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?(this._hash.set("email",this.user.email),this._http.post("/api/user/status",this.user,t=>{t.email&&t.pass?this.login():t.email?this.reset():this.sign()})):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",f({appId:u.appId},this.user),this._set.bind(this))}sign(){this._http.post("/api/user/sign",f({appId:u.appId},this.user),this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,t=>{t?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}};e.\u0275fac=function(i){return new(i||e)(n(q),n(V),n(P),n(M),n(T),n(E),n(N),n(L))},e.\u0275cmp=I({type:e,selectors:[["ng-component"]],standalone:!1,decls:9,vars:4,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img"],[3,"click"],[1,"auth__form"],[1,"auth"],["class","material-icons",3,"click",4,"ngIf"],["class","material-icons auth__icon",3,"click",4,"ngIf"],[3,"wSubmit","submition","config"],[1,"material-icons",3,"click"],[1,"material-icons","auth__icon",3,"click"]],template:function(i,s){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"property-icon",3),m("click",function(){return s.us.setMode(s.us.mode?"":"dark")}),a()(),o(4,"div",4)(5,"div",5),b(6,W,2,0,"span",6)(7,z,2,0,"span",7),o(8,"wform",8),m("wSubmit",function(){return s.submit()}),a()()()()()),i&2&&(c(6),p("ngIf",!s.us.mode),c(),p("ngIf",s.us.mode),c(),p("submition",s.user)("config",s.form))},dependencies:[x,F,U],encapsulation:2});let r=e;return r})();var G=[{path:"",component:D}],me=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=C({type:e}),e.\u0275inj=k({imports:[j.forChild(G),B]});let r=e;return r})();export{me as SignModule};
