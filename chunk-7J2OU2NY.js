import{a as W,b as G}from"./chunk-IMUYPB5B.js";import{a as H}from"./chunk-TRJDFIRG.js";import{e as V,g as q,h as z,k as A}from"./chunk-4JG5HFOE.js";import"./chunk-VV24HN3E.js";import{A as P,Ab as J,Ca as T,K as a,O as l,P as f,Q as S,Qb as Q,Sb as U,U as _,Xa as h,Xb as L,Ya as y,_b as R,ba as m,ca as s,cb as F,da as c,ea as v,ia as I,ja as g,ka as d,lb as B,mb as E,pb as N,ua as p,v as M,va as u,wa as x,wb as $,xa as j,xb as D,z as O}from"./chunk-7J63SMGH.js";function Z(e,t){if(e&1&&(s(0,"i",4),p(1),c()),e&2){let n=d().$implicit;a(),u(n.icon)}}function tt(e,t){if(e&1){let n=I();s(0,"wbutton",2),g("click",function(){let i=O(n),r=i.$implicit,b=i.index,w=d();return r.click(r.name,b),w.clear(),P(r.active=!0)}),_(1,Z,2,1,"i",3),s(2,"span"),p(3),c()()}if(e&2){let n=t.$implicit;m("type",n.active?"primary":"secondary"),a(),m("ngIf",n.icon),a(2),u(n.name)}}var C=(()=>{let t=class t{clear(){for(let o of this.tabs)o.active=!1}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=f({type:t,selectors:[["wtab"]],inputs:{tabs:"tabs"},decls:2,vars:1,consts:[[1,"tabs"],[3,"type","click",4,"ngFor","ngForOf"],[3,"click","type"],["class","material-icons",4,"ngIf"],[1,"material-icons"]],template:function(i,r){i&1&&(s(0,"div",0),_(1,tt,4,3,"wbutton",1),c()),i&2&&(a(),m("ngForOf",r.tabs))},dependencies:[F,h,y,D,$],styles:['@charset "UTF-8";.tabs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}.tabs[_ngcontent-%COMP%]   wbutton[_ngcontent-%COMP%]{padding:5px}.tabs[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{order:1;display:block;padding:1rem 2rem;margin-right:.2rem;cursor:pointer;background:var(--c-basic);font-weight:700;transition:var(--transition);transition:background ease .2s;color:var(--c-white)}.tabs__content[_ngcontent-%COMP%]{order:99;flex-grow:1;width:100%;display:none;padding:1rem;background:var(--c-white)}.tabs[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tabs[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{background:var(--c-white);transition:var(--transition);color:var(--c-basic)}input[type=radio][_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%] + .tabs__content[_ngcontent-%COMP%]{display:block}@media (max-width: 45em){.tabs[_ngcontent-%COMP%]{margin:0 -8px 0 0}.tabs__content[_ngcontent-%COMP%]{order:initial}.tabs[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{order:initial;width:100%;margin-right:0;margin-top:.2rem}}@media screen and (max-width: 767px){.tabs[_ngcontent-%COMP%]{display:flex;white-space:nowrap;flex-wrap:unset;overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;justify-content:unset}.tabs[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.tabs[_ngcontent-%COMP%]   wbutton[_ngcontent-%COMP%]{flex:0 0 auto}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:16px;height:50px}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:22px}}']});let e=t;return e})();function it(e,t){if(e&1&&v(0,"wtab",14),e&2){let n=d();m("tabs",n.jobsTabs)}}function nt(e,t){if(e&1&&(s(0,"div",20)(1,"div",21),p(2),c()()),e&2){let n=t.$implicit,o=d(2);a(2),x(" ",o.serviceById[n.id].name," ")}}function ot(e,t){if(e&1&&(s(0,"div",20)(1,"div",21),p(2),c()()),e&2){let n=t.$implicit,o=d(2);a(2),x(" ",o.materialById[n.id].name," ")}}function rt(e,t){if(e&1&&(s(0,"div",15)(1,"div",16),p(2),c(),s(3,"div",17),p(4),c(),s(5,"div",18),_(6,nt,3,1,"div",19)(7,ot,3,1,"div",19),c()()),e&2){let n=t.$implicit;m("routerLink",T("/job/",n._id)),a(2),u(n.name),a(2),j(" ",n.description," ",n.status," "),a(2),m("ngForOf",n.services),a(),m("ngForOf",n.materials)}}var k=(()=>{let t=class t{constructor(o,i,r,b,w,X){this._jobService=i,this._formService=r,this.userService=b,this._core=w,this._router=X,this.serviceById=U,this.materialById=Q,this.property_id=this._router.url.includes("jobs/")?this._router.url.replace("/jobs/",""):null,this.pagesTabs=(this._core.isMobile()?[]:[{name:"",icon:"add",click:this.create.bind(this)}]).concat([{name:"Materials",icon:"build",click:()=>{this._router.navigateByUrl("/materials")}},{name:"Workers",icon:"group",click:()=>{this._router.navigateByUrl("/workers")}},{name:"Services",icon:"assignment",click:()=>{this._router.navigateByUrl("/services")}}]),this.jobsTabs=[{name:"Mine",click:()=>{this._load(this._mineQuery(),"")},active:!0},{name:"Public",click:()=>{this._load("status=New","public")}},{name:"Assigned",click:()=>{this._load("status=Assigned&worker="+this.userService.user._id,"public")}},{name:"Invoiced",click:()=>{this._load("status=Invoiced&worker="+this.userService.user._id,"public")}},{name:"Paid",click:()=>{this._load("status=Paid&worker="+this.userService.user._id,"public")}},{name:"Completed",click:()=>{this._load("status=Completed&worker="+this.userService.user._id,"public")}}],this.jobs=[],this._form=this._formService.getForm("propertyjob",W),this._query=this._mineQuery(),this._name="",this._load(this._mineQuery())}create(){this._formService.modal(this._form,{label:"Create",click:(o,i)=>{i(),this._jobService.create(o).subscribe(()=>{this._load(this._mineQuery())})}})}_load(o=this._query,i=this._name){this._query=o,this._name=i,this._jobService.get({query:o},{name:i}).subscribe(r=>this.jobs=r)}_mineQuery(){return this.property_id?"property="+this.property_id:""}};t.\u0275fac=function(i){return new(i||t)(l(G),l(H),l(L),l(q),l(J),l(B))},t.\u0275cmp=f({type:t,selectors:[["ng-component"]],standalone:!1,decls:18,vars:3,consts:[[1,"propperty-p"],[1,"documents-wrapper"],[1,"documents-container"],[1,"documents-list"],[1,"documents-header"],[1,"documents-header-left"],["translate","",1,"documents-header__title"],[1,"burger-wrap"],[1,"material-icons",3,"click"],[1,"documents-main"],[1,"documents-main-content"],[1,"tabs",3,"tabs"],["class","mb-10","style","display: block",3,"tabs",4,"ngIf"],["class","documents-main-row row-hover",3,"routerLink",4,"ngFor","ngForOf"],[1,"mb-10",2,"display","block",3,"tabs"],[1,"documents-main-row","row-hover",3,"routerLink"],[1,"documents__title"],[1,"documents__description"],[1,"documents-tags"],["class","documents-tags__wrap",4,"ngFor","ngForOf"],[1,"documents-tags__wrap"],[1,"documents-tags__item"]],template:function(i,r){i&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),v(6,"core-back")(7,"core-profile"),c(),s(8,"div",6),p(9," Common.Jobs "),c(),s(10,"div",7)(11,"i",8),g("click",function(){return r.create()}),p(12,"add"),c()()(),s(13,"div",9)(14,"div",10),v(15,"wtab",11),_(16,it,1,1,"wtab",12)(17,rt,8,7,"div",13),c()()()()()()),i&2&&(a(15),m("tabs",r.pagesTabs),a(),m("ngIf",r.userService.role("propertyworker")&&!r.property_id),a(),m("ngForOf",r.jobs))},dependencies:[E,R,h,y,V,z,C],encapsulation:2});let e=t;return e})();var at=[{path:"",component:k},{path:":property_id",component:k}],Pt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=S({type:t}),t.\u0275inj=M({imports:[N.forChild(at),A,C]});let e=t;return e})();export{Pt as JobsModule};
